---
// SanchezSection.astro - Sección del performer Sanchez (Cowboy Theme)
---

<section class="guy-section sanchez" id="sanchez">
    <!-- Overlay para transición -->
    <div class="section-overlay"></div>
    
    <!-- Background Flashes for Text Area -->
    <div class="text-flashes-container">
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
      <div class="text-flash"></div>
    </div>
    
    <div class="guy-content scroll-reveal">
      <!-- Image Section (LEFT) -->
      <div class="guy-image-container">
        <div class="image-wrapper">
          <!-- Carousel Images (character, action, action2) -->
          <img 
            src="/guys/sanchez/sanchez-character.png" 
            alt="Sanchez - Cowboy"
            class="carousel-image active"
            data-carousel="0"
            loading="lazy"
          />
          <img 
            src="/guys/sanchez/sanchez-action.png" 
            alt="Sanchez in Action"
            class="carousel-image"
            data-carousel="1"
            loading="lazy"
          />
          <img 
            src="/guys/sanchez/sanchez-action2.png" 
            alt="Sanchez Action Scene"
            class="carousel-image"
            data-carousel="2"
            loading="lazy"
          />
          
          <!-- Hover Image -->
          <img 
            src="/guys/sanchez/sanchez-hoover.png" 
            alt="Sanchez Special"
            class="hover-image"
            loading="lazy"
          />
        </div>
      </div>
      
      <!-- Diagonal Golden Line -->
      <div class="diagonal-line"></div>
      
      <!-- Text Section (RIGHT) -->
      <div class="guy-text-container">
        <div class="guy-header">
          <h2 class="guy-name">Sanchez</h2>
          <h3 class="guy-role">cowboy</h3>
        </div>
        
        <p class="guy-description">
          Introducing Sanchez, our rugged cowboy who brings wild west charm and 
          untamed energy to every show. With his commanding presence and authentic 
          frontier style, he delivers performances that are both bold and unforgettable. 
          Whether it's a rodeo-themed event or an evening of western excitement, 
          Sanchez knows how to rope in the crowd.
        </p>
        
        <!-- Tags -->
        <div class="guy-tags">
          <span class="guy-tag">5.8"</span>
          <span class="guy-tag">Ride 'em cowboy</span>
          <span class="guy-tag">Wild at heart</span>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Importar estilos -->
  <style>
    @import url('/src/styles/guys/sanchez-section.css');
  </style>
  
  <script>
    // Variables para el carrusel de Sanchez
    let currentSlide: number = 0;
    const totalSlides: number = 3;
    let carouselInterval: number | null = null;
    let isHovering: boolean = false;
    
    // Función para cambiar de imagen en el carrusel
    function    rotateCarousel(): void {
      // No rotar si el usuario está haciendo hover
      if (isHovering) return;
      
      const carouselImages = document.querySelectorAll('.sanchez .carousel-image');
      
      // Remover clase active de todas las imágenes
      carouselImages.forEach(img => img.classList.remove('active'));
      
      // Incrementar slide
      currentSlide = (currentSlide + 1) % totalSlides;
      
      // Agregar clase active a la imagen actual
      const currentImage = document.querySelector(`.sanchez .carousel-image[data-carousel="${currentSlide}"]`);
      if (currentImage) {
        currentImage.classList.add('active');
      }
    }
    
    // Función para iniciar el carrusel automático
    function startCarousel(): void {
      // Cambiar imagen cada 4 segundos
      carouselInterval = window.setInterval(rotateCarousel, 4000);
    }
    
    // Función para pausar el carrusel
    function pauseCarousel(): void {
      if (carouselInterval !== null) {
        clearInterval(carouselInterval);
        carouselInterval = null;
      }
    }
    
    // Función para manejar el hover
    function handleHover(): void {
      const imageWrapper = document.querySelector('.sanchez .image-wrapper');
      
      if (imageWrapper) {
        imageWrapper.addEventListener('mouseenter', () => {
          isHovering = true;
          pauseCarousel();
        });
        
        imageWrapper.addEventListener('mouseleave', () => {
          isHovering = false;
          startCarousel();
        });
      }
    }
    
    // Inicialización
    document.addEventListener('DOMContentLoaded', () => {
      // Iniciar el carrusel automático
      startCarousel();
      
      // Configurar hover handlers
      handleHover();
      
      // Precargar imágenes para transiciones suaves
      const carouselImages = document.querySelectorAll('.sanchez .carousel-image, .sanchez .hover-image');
      carouselImages.forEach(img => {
        const imgElement = img as HTMLImageElement;
        if (imgElement.src) {
          const preloadImg = new Image();
          preloadImg.src = imgElement.src;
        }
      });
    });
    
    // Limpiar el intervalo al salir de la página
    window.addEventListener('beforeunload', () => {
      pauseCarousel();
    });
    
    // Pausar cuando la página no está visible (ahorro de recursos)
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        pauseCarousel();
      } else if (!isHovering) {
        startCarousel();
      }
    });
  </script>